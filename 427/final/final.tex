\documentclass[10pt]{article}
%%%%%%%%%%%%%%%%%%%%%%%
% Mike's stuff

%% Sample LaTeX for CS427/519
%% Mike Rosulek
%% last update 2017-01-23

\usepackage{xspace,graphicx,amsmath,amssymb,xcolor}
\usepackage[margin=1in]{geometry}
\usepackage{graphicx}
\graphicspath{{images/}}
%% operators

\newcommand{\pct}{\mathbin{\%}}
% makes ":=" aligned better
\usepackage{mathtools}
\mathtoolsset{centercolon}

% indistinguishability operator
% http://tex.stackexchange.com/questions/22168/triple-approx-and-triple-approx-with-a-straight-middle-line
\newcommand{\indist}{  \mathrel{\vcenter{\offinterlineskip
\hbox{$\sim$}\vskip-.35ex\hbox{$\sim$}\vskip-.35ex\hbox{$\sim$}}}}
\renewcommand{\cong}{\indist}

\newcommand{\K}{\mathcal{K}}
\newcommand{\M}{\mathcal{M}}
\newcommand{\C}{\mathcal{C}}
\newcommand{\Z}{\mathbb{Z}}

\newcommand{\Enc}{\text{\sf Enc}}
\newcommand{\Dec}{\text{\sf Dec}}
\newcommand{\KeyGen}{\text{\sf KeyGen}}

% fancy script L
\usepackage[mathscr]{euscript}
\renewcommand{\L}{\ensuremath{\mathscr{L}}\xspace}
\newcommand{\lib}[1]{\ensuremath{\L_{\textsf{#1}}}\xspace}

\newcommand{\myterm}[1]{\ensuremath{\text{#1}}\xspace}
\newcommand{\bias}{\myterm{bias}}
\newcommand{\link}{\diamond}
\newcommand{\subname}[1]{\ensuremath{\textsc{#1}}\xspace}

%% colors
\definecolor{highlightcolor}{HTML}{F5F5A4}
\definecolor{highlighttextcolor}{HTML}{000000}
\definecolor{bitcolor}{HTML}{a91616}

%%% boxes for writing libraries/constructions
\usepackage{varwidth}

\newcommand{\codebox}[1]{%
	\begin{varwidth}{\linewidth}%
		\begin{tabbing}%
			~~~\=\quad\=\quad\=\quad\=\kill % initialize tabstops
			#1
		\end{tabbing}%
	\end{varwidth}%
}
\newcommand{\titlecodebox}[2]{%
	\fboxsep=0pt%
	\fcolorbox{black}{black!10}{%
		\begin{varwidth}{\linewidth}%
			\centering%
			\fboxsep=3pt%
			\colorbox{black!10}{#1} \\
			\colorbox{white}{\codebox{#2}}%
		\end{varwidth}%
	}
}
\newcommand{\fcodebox}[1]{%
	\framebox{\codebox{#1}}%
}
\newcommand{\hlcodebox}[1]{%
	\fcolorbox{black}{highlightcolor}{\codebox{#1}}%
}
\newcommand{\hltitlecodebox}[2]{%
	\fboxsep=0pt%
	\fcolorbox{black}{black!15!highlightcolor}{%
		\begin{varwidth}{\linewidth}%
			\centering%
			\fboxsep=3pt%
			\colorbox{black!15!highlightcolor}{\color{highlighttextcolor}#1} \\
			\colorbox{highlightcolor}{\color{highlighttextcolor}\codebox{#2}}%
		\end{varwidth}%
	}
}


%% highlighting
\newcommand{\basehighlight}[1]{\colorbox{highlightcolor}{\color{highlighttextcolor}#1}}
\newcommand{\mathhighlight}[1]{\basehighlight{$#1$}}
\newcommand{\highlight}[1]{\raisebox{0pt}[-\fboxsep][-\fboxsep]{\basehighlight{#1}}}
\newcommand{\highlightline}[1]{%\raisebox{0pt}[-\fboxsep][-\fboxsep]{
	\hspace*{-\fboxsep}\basehighlight{#1}%
	%}
}

%% bits
\newcommand{\bit}[1]{\textcolor{bitcolor}{\texttt{\upshape #1}}}
\newcommand{\bits}{\{\bit0,\bit1\}}



%%%%%%%%%%%%%%%%%%%%%%%

\begin{document}
\title{CS 427, Final Project\\ POODLE\\ Padding Oracle on Downgraded Legacy
Encryption}
\author{Cody Malick\\
\texttt{malickc@oregonstate.edu}}
\date{\today}
\maketitle
\vspace{4cm}

\begin{abstract}
	This paper outlines the POODLE exploit. It gives details on how it
	allows an adversary to repeatedly query a server using SSL version 3.0,
	and eventually decrypt a block one byte at a time. The exploit was
	first published by the
	Google Security Team on October 14, 2014 by Bodo Moller, Thai Duong,
	and Kryzsztof Kotowicz. While SSL version 3.0 is quite old, it is still
	in use today for browser backward compatibility. Later, an updated
	version of the POODLE exploit was published showing successful attacks
	against TLS.

\end{abstract}

\clearpage

\section*{Introduction}
POODLE is an attack on Secure Socket Layer version 3.0 that was made public
in 2014. It was announced on Google's Security Blog, co-published by Bodo Moller,
Thai Duong, and Kryzsztof Kotowicz. POODLE allows an attacker targeting SSL 3.0
to decrypt one byte of an encrypted SSL block one out of two-hundred fifty-six 
attempts. While this is an average, being able to decrypt a byte of an encrypted
block that quickly is quite a security flaw.\cite{POODLE} It was later found
that the vulnerability extended to TLS version 1.0. It is
more of an implementation problem. Some implementations of TLS in popular software
did not correctly check the padding after decryption. \cite{POODLEBites}

The goal of SSLv3 was to encrypt and keep secret communication between a web
browser, and a web server. This is accomplished through an initial secret-sharing
hand shake. It then computes a MAC from the shared secret. Once message exchange
begins, it uses AES CBC-Mode to encrypt and decrypt messages.\cite{SSLv3} The
goal of the protocol was to provided secrecy, authenticity, and integrity. 

POODLE is executed using a padding oracle attack. A padding oracle attack, simply
described, is abusing the fact that a web server will through an error on a valid
ciphertext if the padding is bad. This allows an attacker to verify whether or
not an arbitrary ciphertext has valid padding. Furthermore, with this information,
and adversary can decrypt the arbitrary ciphertexts!\cite{rosulek}

\section*{Context}
To completely understand the attack, the context should first be made clear. 
SSL version 3.0 is quite dated, and should for all intents and purposes be 
completely retired. Modern browsers, however, use SSLv3 as a fall back for
compatibility purposes. The browser will first try to connect to the web server
using TLS version 1.2, the de facto standard for web communication. If that fails,
it is default behavior in browsers to fall back to earlier standards, such as SSLv3.\cite{POODLE}

While browsers continue to support SSLv3, this attack will continue to be an
issue. A savvy attacker with the proper resources could catch web requests with
a man in the middle attack, and prevent all non-SSLv3 requests from going through.
This would force the use of SSLv3 if it is supported by the web server.\cite{MozillaPOODLE} 

\subsection*{Padding}
The primary point of vulnerability that the attack exploits is in the padding
of the encrypted message. Padding in SSLv3 is accomplished by measuring the 
difference between the last block size, and the required size of the block. In
this case, the block size must be a multiple of sixteen. In this case, the AES
CBC mode block size is sixteen bytes, sixty-four bits. The SSLv3 implementation
then measures the difference $d$, and fills the space $d-1$ with random byte
values. The last byte is then filled with the size of the padding. The padding
can be zero, or a maximum of sixty-three bytes.\cite{SSLv3}
SSLv3 does not check 

When attempting to decrypt, the algorithm checks the last byte for the size of
the padding. The major issue with this becomes apparent here. Because the padding
of SSLv3 is nondeterministic and the padding is not covered by the message
authentication code provided, any value can be provided in the place of the
padding byte.\cite{POODLE} More on this in the 'exploit' section.

\subsection*{AES CBC Mode}
Cipherblock Chaining mode is one of the most popular modes for AES operation.
It provides chosen plaintext attack security, and non-deterministic encryption
using an initialization vector. Here is a diagram from the class textbook that
illustrates how this process works:\cite{rosulek}

\includegraphics[scale=0.5]{cbcmode}

While understanding the underlying encryption algorithm is important to understanding
the exploit, the primary point of vulnerability is the padding.

\section*{The Exploit}
The exploit is accomplished by executing the following steps:

\subsubsection*{SSL Version 3.0 Fallback}
While not required, the vast majority of modern web browsers and web servers use
modern versions of TLS. Per Mozilla, which has since completely disabled SSLv3
in the browser, only about 0.3\% of all their requests used SSLv3.\cite{MozillaPOODLE}
With that in mind, it is likely that an adversary wishing to utilize this attack
must first force the web browser to fall back to SSLv3. This would typically be
done during the initial connection between the web browser and web server when
they first try to agree on a protocol to use. 

An adversary, with a man-in-the-middle setup, could disallow any connections
that were not SSLv3. If both the web browser and web server support SSLv3, they
would eventually fall back on using the protocol.\cite{POODLE} Once the connection
has been established, the stage is set for the attack.

\subsubsection*{Replacing the Padding Block}
Because SSLv3 does not verify the integrity of the padding, or the padding byte
due to its nondeterministic nature, this is the point of attack. An adversary
who is able to intercept and alter traffic (our man-in-the-middle setup) can
replace the padding block with any other block. 

More formally, given ciphertext blocks $C_1 ... C_n$, an initialization vector
$C_0$, and the block-cipher decryption $D_k$ using key $K$, the recipient of
the message would use the following process to decrypt:\cite{POODLE}\\

\noindent $P_1 ... P_n, P_i\ =\ D_K(C_i)\ \oplus\ C_{i-1}$\\


The receiver would then check the padding on the end ($C_n$), and verify the
MAC. The attacker could replace $C_n$ with any other block of encrypted
ciphertext $C_i$ from the same message. Then the ciphertext will still be
accepted if the decryption of the last byte of block $C_i$ is equal to the
value of the padding byte. This is the padding oracle attack. \cite{POODLE}.

This means that the attacker knows that the last byte of the decrypted message
was in-fact equal to the value of the padding byte. The probability of this
attack being successful turns out to be extremely probable. With only two-hundred
fifty-six possibilities for any given byte, the probability of success simply
$\frac{1}{256}$. With such a reliable attack, the attacker can easily iterate
through the ciphertext blocks, shifting the bytes when a new byte has been
decrypted. This allows for full decryption of entire blocks given enough time.
Being able to make several hundred or thousand attacks in a few seconds means 
that an adversary can reliably decrypt one byte of a message at a time.

While this is fairly devastating, it should again be pointed out that an attacker
must already have a fairly compromised system in order to execute this method.
The attacker must have two requirements in place: the attacker must control
some part of the client side connection, and the attacker must have visibility
of the resulting ciphertext. These two prerequisites require a fairly
compromised system to begin with.\cite{US-CERT}

\section*{TLS 1.0 Vulnerability}
It was discovered a few months after the initial POODLE announcement was made
that certain implementations of TLS were vulnerable to the attack. TLS, unlike
SSLv3, is very strict in the formatting of its padding. Certain implementations,
however, did not check the padding structure after decryption. This leads to the
same vulnerability to padding oracle attacks that SSLv3 had, minus the need to
downgrade the security protocol being used.\cite{POODLEBites}

\section*{The Fix}
There is a patch released for SSLv3 to prevent the POODLE vulnerability. The patch
only works, however, if both the client and the server are up to date. The real
danger lies in the fact that SSLv3 is a deprecated protocol that should no longer
be used.\cite{disablessl3} It's hard if not impossible to ensure that every
server or client is patched and up to date with the latest SSLv3 versions. More
importantly, many websites and modern browsers have completely disabled SSLv3 to
prevent POODLE from being an issue in the first place. Modern browsers enforce
the use of TLS 1.2, and will fail to connect to older servers that do not support
modern encryption standards.

\bibliography{references}
\bibliographystyle{IEEEtran}
\end{document}
